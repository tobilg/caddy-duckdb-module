# Example Caddyfile for DuckDB Extension

# Basic configuration with in-memory database
:8080 {
	route /duckdb/* {
		duckdb {
			# Main database (omit for in-memory)
			# database_path /data/main.db

			# Auth database (required, must be file-based)
			auth_database_path /tmp/data/auth.db

			# Query timeout (default: 10s)
			query_timeout 10s

			# Maximum rows per page (default: 100)
			max_rows_per_page 100

			# Safety limit - max rows without pagination (default: 10000, 0 to disable)
			absolute_max_rows 10000

			# Number of threads (default: 4)
			threads 4

			# Access mode: read_only or read_write (default: read_write)
			access_mode read_write

			# Memory limit (optional, e.g., "4GB", "512MB". Default: 80% of RAM)
			# memory_limit 4GB

			# Enable object cache for faster repeated queries (optional, default: false)
			# enable_object_cache true

			# Temporary directory for spilling to disk (optional, uses system default if not set)
			# temp_directory /tmp/duckdb-temp
		}
	}
}

# Production configuration with file-based database
# :443 {
# 	route /duckdb/* {
# 		duckdb {
# 			database_path /var/lib/duckdb/main.db
# 			auth_database_path /var/lib/duckdb/auth.db
# 			query_timeout 30s
# 			max_rows_per_page 1000
# 			absolute_max_rows 50000
# 			threads 8
# 			access_mode read_write
# 			memory_limit 8GB
# 			enable_object_cache true
# 			temp_directory /var/tmp/duckdb
# 		}
# 	}
#
# 	tls {
# 		# Your TLS configuration
# 	}
# }
